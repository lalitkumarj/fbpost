{% autoescape true %}
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>Facebook OAuth Example</title>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  </head>
  <body>
    {% if current_user %}
    <p><a href="{{ current_user.profile_url }}"><img src="http://graph.facebook.com/{{ current_user.id }}/picture"/></a></p>
    <p>You are logged in as {{ current_user.name|escape }}</p>
    <p><a href="/logout">Log out</a></p>
    {% else %}
    <p>You are not yet logged into this site</p>
    <p><a href="/login">Log in with Facebook</a></p>
    {% endif %}
    
    
    <form id="description_form" class="form-inline">
      <div class="form-group">
	<label for="description_input">Description </label>
	<textarea id="description_input" name="description_input" class="form-control" rows="10"></textarea> 	
	<input type="submit" class="btn btn-default" value="Submit">
	{% for page in pages %}
	<input type="checkbox" name="select_pages" value="{{page.id}}"> {{page.name}} </input>
	{% endfor %}
	<br/><br/><br/>
	{% for group in groups %}
	<input type="checkbox" name="select_groups" value="{{group.id}}"> {{group.name}} </input>
	{% endfor %}
	
	</div>
      </form>
      
     <script>
	$("#description_form").on( "submit", function (event) {
	console.log($(this).serialize() );
	
	$.post("/form/post", $("#description_form").serialize());
	$("#description_form")[0].reset();
	return false;
	} );
      </script>
      -->
      <div id="progress">
	<div class="bar" style="width: 0%;height: 10px; background: green;"></div>
      </div>


      <input id="fileupload" type="file" name="files[]" data-url="/form/image" multiple>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	<script src="js/vendor/jquery.ui.widget.js"></script>
	<script src="js/jquery.iframe-transport.js"></script>
	<script src="js/jquery.fileupload.js"></script>
	<script>
	  
	  $(function () {
	  $('#fileupload').fileupload({
          dataType: 'json',
          add: function (e, data) {
          data.context = $('<button/>').text('Upload')
          .appendTo(document.body)
          .click(function () {
          data.context = $('<p/>').text('Uploading...').replaceAll($(this));
          data.submit();
          //$.post("/form/post", $("#description_form").serialize());
	  //$("#description_form")[0].reset();
          });
          },
          done: function (e, data) {
          data.context.text('Upload finished.');
          }
          , progressall: function (e, data) {
    	  var progress = parseInt(data.loaded / data.total * 100, 10);
          $('#progress .bar').css(
          'width',
            progress + '%'
          );
	  }
	  });
	  });
	</script>



    </body>
  </html>
  {% endautoescape %}
  
